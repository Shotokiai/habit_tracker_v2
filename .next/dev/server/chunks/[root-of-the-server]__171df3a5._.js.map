{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["C:/Files/acer/Personal Projects/habit_tracker_app/code (1)/pages/api/track-habit-started.ts"],"sourcesContent":["import type { NextApiRequest, NextApiResponse } from 'next'\r\n\r\nconst SHEETDB_URL = process.env.SHEETDB_URL || 'https://sheetdb.io/api/v1/wy27jygmvuwkz'\r\n\r\nexport default async function handler(req: NextApiRequest, res: NextApiResponse) {\r\n  if (req.method !== 'POST') {\r\n    return res.status(405).json({ error: 'Method not allowed' })\r\n  }\r\n\r\n  const { email, habitName, habitStartedAt } = req.body\r\n  if (!email || !habitName || !habitStartedAt) {\r\n    return res.status(400).json({ error: 'Missing email, habitName, or habitStartedAt' })\r\n  }\r\n\r\n  try {\r\n    // Update the user record with habit start time\r\n    const response = await fetch(`${SHEETDB_URL}/email/${encodeURIComponent(email)}`, {\r\n      method: 'PUT',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify({\r\n        data: {\r\n          habit_started_at: habitStartedAt\r\n        }\r\n      }),\r\n    })\r\n\r\n    if (!response.ok) {\r\n      const text = await response.text()\r\n      console.error('SheetDB error:', response.status, text)\r\n      return res.status(500).json({ error: 'Failed to update SheetDB' })\r\n    }\r\n\r\n    return res.status(200).json({ success: true })\r\n  } catch (err) {\r\n    console.error('track-habit-started error', err)\r\n    return res.status(500).json({ error: 'Internal server error' })\r\n  }\r\n}"],"names":["NextApiRequest","NextApiResponse","SHEETDB_URL","process","env","handler","req","res","method","status","json","error","email","habitName","habitStartedAt","body","response","fetch","encodeURIComponent","headers","JSON","stringify","data","habit_started_at","ok","text","console","success","err"],"mappings":";;;;AAEA,MAAME,WAAW,GAAGC,OAAO,CAACC,GAAG,CAACF,WAAW,IAAI,yCAAyC;AAEzE,eAAeG,OAAOA,CAACC,GAAG,AAAgB,EAAdN,AAAgBO,GAAG,AAAiB,EAAfN,AAAiB;IAC/E,IAAIK,GAAG,CAACE,MAAM,KAAK,MAAM,EAAE;QACzB,OAAOD,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;YAAEC,KAAK,EAAE;QAAqB,CAAC,CAAC;IAC9D;IAEA,MAAM,EAAEC,KAAK,EAAEC,SAAS,EAAEC,cAAAA,EAAgB,GAAGR,GAAG,CAACS,IAAI;IACrD,IAAI,CAACH,KAAK,IAAI,CAACC,SAAS,IAAI,CAACC,cAAc,EAAE;QAC3C,OAAOP,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;YAAEC,KAAK,EAAE;QAA8C,CAAC,CAAC;IACvF;IAEA,IAAI;QACF,+CAAA;QACA,MAAMK,QAAQ,GAAG,MAAMC,KAAK,CAAC,GAAGf,WAAW,CAAA,OAAA,EAAUgB,kBAAkB,CAACN,KAAK,CAAC,EAAE,EAAE;YAChFJ,MAAM,EAAE,KAAK;YACbW,OAAO,EAAE;gBACP,cAAc,EAAE;YAClB,CAAC;YACDJ,IAAI,EAAEK,IAAI,CAACC,SAAS,CAAC;gBACnBC,IAAI,EAAE;oBACJC,gBAAgB,EAAET;gBACpB;YACF,CAAC;QACH,CAAC,CAAC;QAEF,IAAI,CAACE,QAAQ,CAACQ,EAAE,EAAE;YAChB,MAAMC,IAAI,GAAG,MAAMT,QAAQ,CAACS,IAAI,CAAC,CAAC;YAClCC,OAAO,CAACf,KAAK,CAAC,gBAAgB,EAAEK,QAAQ,CAACP,MAAM,EAAEgB,IAAI,CAAC;YACtD,OAAOlB,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;gBAAEC,KAAK,EAAE;YAA2B,CAAC,CAAC;QACpE;QAEA,OAAOJ,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;YAAEiB,OAAO,EAAE;QAAK,CAAC,CAAC;IAChD,CAAC,CAAC,OAAOC,GAAG,EAAE;QACZF,OAAO,CAACf,KAAK,CAAC,2BAA2B,EAAEiB,GAAG,CAAC;QAC/C,OAAOrB,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;YAAEC,KAAK,EAAE;QAAwB,CAAC,CAAC;IACjE;AACF","ignoreList":[]}}]
}