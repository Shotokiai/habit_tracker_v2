{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["C:/Files/acer/Personal Projects/habit_tracker_app/code (1)/pages/api/register-user.ts"],"sourcesContent":["import type { NextApiRequest, NextApiResponse } from 'next'\r\n\r\n// This route forwards user registration data to SheetDB (Google Sheets API)\r\n// Set the SheetDB endpoint in environment variable SHEETDB_URL or it will\r\n// fall back to the endpoint you provided.\r\nconst SHEETDB_URL = process.env.SHEETDB_URL || 'https://sheetdb.io/api/v1/wy27jygmvuwkz'\r\n\r\nexport default async function handler(req: NextApiRequest, res: NextApiResponse) {\r\n  if (req.method !== 'POST') {\r\n    return res.status(405).json({ error: 'Method not allowed' })\r\n  }\r\n\r\n  const { username, email, age } = req.body\r\n  if (!username || !email || !age) {\r\n    return res.status(400).json({ error: 'Missing username, email, or age' })\r\n  }\r\n\r\n  // Validate age is between 15 and 80\r\n  const ageNum = parseInt(age, 10)\r\n  if (isNaN(ageNum) || ageNum < 15 || ageNum > 80) {\r\n    return res.status(400).json({ error: 'Age must be between 15 and 80' })\r\n  }\r\n\r\n  try {\r\n    const response = await fetch(SHEETDB_URL, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify({\r\n        data: [{ \r\n          username, \r\n          email, \r\n          age: ageNum, \r\n          new_habit_creation: '', \r\n          createdAt: new Date().toISOString(),\r\n          habit_created_at: '',\r\n          habit_started_at: ''\r\n        }]\r\n      }),\r\n    })\r\n\r\n    if (!response.ok) {\r\n      const text = await response.text()\r\n      console.error('SheetDB error:', response.status, text)\r\n      return res.status(500).json({ error: 'Failed to save to SheetDB' })\r\n    }\r\n\r\n    return res.status(200).json({ success: true })\r\n  } catch (err) {\r\n    console.error('register-user error', err)\r\n    return res.status(500).json({ error: 'Internal server error' })\r\n  }\r\n}\r\n"],"names":["NextApiRequest","NextApiResponse","SHEETDB_URL","process","env","handler","req","res","method","status","json","error","username","email","age","body","ageNum","parseInt","isNaN","response","fetch","headers","JSON","stringify","data","new_habit_creation","createdAt","Date","toISOString","habit_created_at","habit_started_at","ok","text","console","success","err"],"mappings":";;;;AAEA,4EAAA;AACA,0EAAA;AACA,0CAAA;AACA,MAAME,WAAW,GAAGC,OAAO,CAACC,GAAG,CAACF,WAAW,IAAI,yCAAyC;AAEzE,eAAeG,OAAOA,CAACC,GAAG,AAAgB,EAAdN,AAAgBO,GAAoB,AAAjB,EAAEN,AAAiB;IAC/E,IAAIK,GAAG,CAACE,MAAM,KAAK,MAAM,EAAE;QACzB,OAAOD,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;YAAEC,KAAK,EAAE;QAAqB,CAAC,CAAC;IAC9D;IAEA,MAAM,EAAEC,QAAQ,EAAEC,KAAK,EAAEC,GAAAA,EAAK,GAAGR,GAAG,CAACS,IAAI;IACzC,IAAI,CAACH,QAAQ,IAAI,CAACC,KAAK,IAAI,CAACC,GAAG,EAAE;QAC/B,OAAOP,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;YAAEC,KAAK,EAAE;QAAkC,CAAC,CAAC;IAC3E;IAEA,oCAAA;IACA,MAAMK,MAAM,GAAGC,QAAQ,CAACH,GAAG,EAAE,EAAE,CAAC;IAChC,IAAII,KAAK,CAACF,MAAM,CAAC,IAAIA,MAAM,GAAG,EAAE,IAAIA,MAAM,GAAG,EAAE,EAAE;QAC/C,OAAOT,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;YAAEC,KAAK,EAAE;QAAgC,CAAC,CAAC;IACzE;IAEA,IAAI;QACF,MAAMQ,QAAQ,GAAG,MAAMC,KAAK,CAAClB,WAAW,EAAE;YACxCM,MAAM,EAAE,MAAM;YACda,OAAO,EAAE;gBACP,cAAc,EAAE;YAClB,CAAC;YACDN,IAAI,EAAEO,IAAI,CAACC,SAAS,CAAC;gBACnBC,IAAI,EAAE;oBAAC;wBACLZ,QAAQ;wBACRC,KAAK;wBACLC,GAAG,EAAEE,MAAM;wBACXS,kBAAkB,EAAE,EAAE;wBACtBC,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC;wBACnCC,gBAAgB,EAAE,EAAE;wBACpBC,gBAAgB,EAAE;oBACpB,CAAC;iBAAA;YACH,CAAC;QACH,CAAC,CAAC;QAEF,IAAI,CAACX,QAAQ,CAACY,EAAE,EAAE;YAChB,MAAMC,IAAI,GAAG,MAAMb,QAAQ,CAACa,IAAI,CAAC,CAAC;YAClCC,OAAO,CAACtB,KAAK,CAAC,gBAAgB,EAAEQ,QAAQ,CAACV,MAAM,EAAEuB,IAAI,CAAC;YACtD,OAAOzB,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;gBAAEC,KAAK,EAAE;YAA4B,CAAC,CAAC;QACrE;QAEA,OAAOJ,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;YAAEwB,OAAO,EAAE;QAAK,CAAC,CAAC;IAChD,CAAC,CAAC,OAAOC,GAAG,EAAE;QACZF,OAAO,CAACtB,KAAK,CAAC,qBAAqB,EAAEwB,GAAG,CAAC;QACzC,OAAO5B,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;YAAEC,KAAK,EAAE;QAAwB,CAAC,CAAC;IACjE;AACF","ignoreList":[]}}]
}