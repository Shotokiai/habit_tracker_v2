{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["C:/Files/acer/Personal Projects/habit_tracker_app/code (1)/pages/api/track-custom-habit.ts"],"sourcesContent":["import type { NextApiRequest, NextApiResponse } from 'next'\r\n\r\n// This route forwards custom habit creation data to SheetDB (Google Sheets API)\r\nconst SHEETDB_URL = process.env.SHEETDB_URL || 'https://sheetdb.io/api/v1/wy27jygmvuwkz'\r\n\r\nexport default async function handler(req: NextApiRequest, res: NextApiResponse) {\r\n  if (req.method !== 'POST') {\r\n    return res.status(405).json({ error: 'Method not allowed' })\r\n  }\r\n\r\n  const { habitName, habitType, userAge, userName } = req.body\r\n  if (!habitName || !habitType) {\r\n    return res.status(400).json({ error: 'Missing habit name or type' })\r\n  }\r\n\r\n  try {\r\n    // Update the existing user record with the new custom habit\r\n    const customHabitData = `${habitType}: ${habitName} (Age: ${userAge})`\r\n    \r\n    const response = await fetch(SHEETDB_URL, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify({ \r\n        data: { \r\n          username: userName || 'Unknown',\r\n          email: '',\r\n          age: userAge || 0,\r\n          new_habit_creation: customHabitData,\r\n          createdAt: new Date().toISOString() \r\n        } \r\n      }),\r\n    })\r\n\r\n    if (!response.ok) {\r\n      const text = await response.text()\r\n      console.error('SheetDB error:', response.status, text)\r\n      return res.status(500).json({ error: 'Failed to save to SheetDB' })\r\n    }\r\n\r\n    return res.status(200).json({ success: true })\r\n  } catch (err) {\r\n    console.error('track-custom-habit error', err)\r\n    return res.status(500).json({ error: 'Internal server error' })\r\n  }\r\n}"],"names":["NextApiRequest","NextApiResponse","SHEETDB_URL","process","env","handler","req","res","method","status","json","error","habitName","habitType","userAge","userName","body","customHabitData","response","fetch","headers","JSON","stringify","data","username","email","age","new_habit_creation","createdAt","Date","toISOString","ok","text","console","success","err"],"mappings":";;;;AAEA,gFAAA;AACA,MAAME,WAAW,GAAGC,OAAO,CAACC,GAAG,CAACF,WAAW,IAAI,yCAAyC;AAEzE,eAAeG,OAAOA,CAACC,GAAG,AAAgB,EAAdN,AAAgBO,GAAoB,AAAjB,EAAEN,AAAiB;IAC/E,IAAIK,GAAG,CAACE,MAAM,KAAK,MAAM,EAAE;QACzB,OAAOD,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;YAAEC,KAAK,EAAE;QAAqB,CAAC,CAAC;IAC9D;IAEA,MAAM,EAAEC,SAAS,EAAEC,SAAS,EAAEC,OAAO,EAAEC,QAAAA,EAAU,GAAGT,GAAG,CAACU,IAAI;IAC5D,IAAI,CAACJ,SAAS,IAAI,CAACC,SAAS,EAAE;QAC5B,OAAON,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;YAAEC,KAAK,EAAE;QAA6B,CAAC,CAAC;IACtE;IAEA,IAAI;QACF,4DAAA;QACA,MAAMM,eAAe,GAAG,GAAGJ,SAAS,CAAA,EAAA,EAAKD,SAAS,CAAA,OAAA,EAAUE,OAAO,CAAA,CAAA,CAAG;QAEtE,MAAMI,QAAQ,GAAG,MAAMC,KAAK,CAACjB,WAAW,EAAE;YACxCM,MAAM,EAAE,MAAM;YACdY,OAAO,EAAE;gBACP,cAAc,EAAE;YAClB,CAAC;YACDJ,IAAI,EAAEK,IAAI,CAACC,SAAS,CAAC;gBACnBC,IAAI,EAAE;oBACJC,QAAQ,EAAET,QAAQ,IAAI,SAAS;oBAC/BU,KAAK,EAAE,EAAE;oBACTC,GAAG,EAAEZ,OAAO,IAAI,CAAC;oBACjBa,kBAAkB,EAAEV,eAAe;oBACnCW,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC;gBACpC;YACF,CAAC;QACH,CAAC,CAAC;QAEF,IAAI,CAACZ,QAAQ,CAACa,EAAE,EAAE;YAChB,MAAMC,IAAI,GAAG,MAAMd,QAAQ,CAACc,IAAI,CAAC,CAAC;YAClCC,OAAO,CAACtB,KAAK,CAAC,gBAAgB,EAAEO,QAAQ,CAACT,MAAM,EAAEuB,IAAI,CAAC;YACtD,OAAOzB,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;gBAAEC,KAAK,EAAE;YAA4B,CAAC,CAAC;QACrE;QAEA,OAAOJ,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;YAAEwB,OAAO,EAAE;QAAK,CAAC,CAAC;IAChD,CAAC,CAAC,OAAOC,GAAG,EAAE;QACZF,OAAO,CAACtB,KAAK,CAAC,0BAA0B,EAAEwB,GAAG,CAAC;QAC9C,OAAO5B,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;YAAEC,KAAK,EAAE;QAAwB,CAAC,CAAC;IACjE;AACF","ignoreList":[]}}]
}