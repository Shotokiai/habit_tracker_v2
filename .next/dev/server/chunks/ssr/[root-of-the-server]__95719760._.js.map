{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 14, "column": 0}, "map": {"version":3,"sources":["file:///C:/Files/acer/Personal%20Projects/habit_tracker_app/code%20%281%29/app/page.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/app/page.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/app/page.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,uXAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAgR,GAC7S,8CACA","ignoreList":[0]}},
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///C:/Files/acer/Personal%20Projects/habit_tracker_app/code%20%281%29/app/page.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/app/page.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/app/page.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,uXAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAA4P,GACzR,0BACA","ignoreList":[0]}},
    {"offset": {"line": 42, "column": 0}, "map": {"version":3,"sources":["C:/Files/acer/Personal Projects/habit_tracker_app/code (1)/app/page.tsx"],"sourcesContent":["\"use client\"\r\n\r\n\r\nimport { useState, useEffect } from \"react\"\r\nimport HabitTracker from \"@/components/habit-tracker\"\r\nimport FirstUserForm from \"@/components/first-user-form\"\r\nimport HabitSelection from \"@/components/habit-selection\"\r\nimport CustomHabitScreen from \"@/components/CustomHabitScreen\"\r\nimport type { Habit, DayRecord } from \"@/lib/types\"\r\n\r\n\r\nexport default function Page() {\r\n  const [habits, setHabits] = useState<Habit[]>([]);\r\n  const [currentHabitIndex, setCurrentHabitIndex] = useState(0);\r\n  const [isLoaded, setIsLoaded] = useState(false);\r\n  const [touchStart, setTouchStart] = useState(0);\r\n  const [touchEnd, setTouchEnd] = useState(0);\r\n  const [swipeStartFromNav, setSwipeStartFromNav] = useState(false);\r\n  const [user, setUser] = useState<{ username: string; age: number; email: string } | null>(null);\r\n  const [habitSelection, setHabitSelection] = useState<string | null>(null);\r\n  const [customHabitType, setCustomHabitType] = useState<\"make\" | \"break\" | null>(null);\r\n  const [showHabitSelection, setShowHabitSelection] = useState(false);\r\n  const [showProfileDrawer, setShowProfileDrawer] = useState(false);\r\n  const [showLogoutConfirmation, setShowLogoutConfirmation] = useState(false);\r\n  const [currentView, setCurrentView] = useState<'chart' | 'calendar' | 'companion'>('chart');\r\n\r\n  // Helper function to get full habit name from key\r\n  const getHabitNameFromKey = (key: string): string => {\r\n    // Age-based habit mappings\r\n    const allHabits = [\r\n      // 15-20 years\r\n      { key: \"study\", label: \"Study focused for 25 mins\" },\r\n      { key: \"walk\", label: \"Walk briskly 15 mins daily\" },\r\n      { key: \"meditate\", label: \"Meditate calmly for 10 mins\" },\r\n      { key: \"read\", label: \"Read 10 pages daily\" },\r\n      { key: \"noPhone\", label: \"No phone after 9 PM\" },\r\n      { key: \"noSoda\", label: \"Skip soda daily\" },\r\n      { key: \"sleep\", label: \"Avoid sleeping less than 7 hours\" },\r\n      { key: \"noJunk\", label: \"Avoid junk food daily\" },\r\n      { key: \"noPackaged\", label: \"No packaged foods\" },\r\n      // 20-25 years\r\n      { key: \"save\", label: \"Saved â‚¹100 everyday\" },\r\n      { key: \"cook\", label: \"Cook breakfast before work\" },\r\n      { key: \"callFriend\", label: \"Call one friend after dinner\" },\r\n      { key: \"stretch\", label: \"Stretch after waking up\" },\r\n      { key: \"limitCoffee\", label: \"Limit coffee to one cup\" },\r\n      { key: \"noScreens\", label: \"No screens after 10 PM\" },\r\n      { key: \"walkInstead\", label: \"Walk instead of driving short distances\" },\r\n      { key: \"noLateNights\", label: \"Cut late nights\" },\r\n      // 25-30 years\r\n      { key: \"readNews\", label: \"Read news during morning tea\" },\r\n      { key: \"water\", label: \"Drink 2L of water daily\" },\r\n      { key: \"hobby\", label: \"Do hobby 20 mins daily\" },\r\n      { key: \"planMeals\", label: \"Plan meals for the week\" },\r\n      { key: \"noEatingOut\", label: \"No eating out daily\" },\r\n      { key: \"workLimit\", label: \"Work limit 8 hours\" },\r\n      { key: \"noSnacks\", label: \"No snacks after 8 PM\" },\r\n      { key: \"trackExpenses\", label: \"Track daily expenses\" },\r\n      // 30-35 years\r\n      { key: \"familyChat\", label: \"Family chat 15 mins\" },\r\n      { key: \"strength\", label: \"Strength training 20 mins\" },\r\n      { key: \"breathing\", label: \"Deep breathing after waking up\" },\r\n      { key: \"journal\", label: \"Journal before sleep\" },\r\n      { key: \"oneTask\", label: \"One task at a time (no multitasking)\" },\r\n      { key: \"noSugary\", label: \"Skip sugary drinks\" },\r\n      { key: \"bedtime\", label: \"Bedtime by 11 PM\" },\r\n      { key: \"noWeekendBinge\", label: \"No weekend screen binge\" },\r\n      // 35-40 years\r\n      { key: \"freshLunch\", label: \"Lunch cooked fresh daily\" },\r\n      { key: \"morningWalk\", label: \"Morning walk before 8 AM\" },\r\n      { key: \"waterMorning\", label: \"Drink 2 glasses of water in the morning\" },\r\n      { key: \"stretchDaily\", label: \"Stretch 10 mins daily\" },\r\n      { key: \"noFoodAfter8\", label: \"No food after 8 PM\" },\r\n      { key: \"stand2Min\", label: \"Stand for 2 minutes every hour\" },\r\n      { key: \"moveHourly\", label: \"Move body every hour\" },\r\n      { key: \"reduceAlcohol\", label: \"Reduce alcohol intake\" },\r\n      // 40+ years\r\n      { key: \"yoga\", label: \"Yoga 15 mins\" },\r\n      { key: \"stretchBed\", label: \"Stretch before bed\" },\r\n      { key: \"fruitBreakfast\", label: \"Eat fruit with breakfast\" },\r\n      { key: \"puzzle\", label: \"Solve puzzle 10 mins\" },\r\n      { key: \"noProcessed\", label: \"No processed packaged foods\" },\r\n      { key: \"stand30Min\", label: \"Stand every 30 mins\" },\r\n      { key: \"limitSugar\", label: \"Limit sugar intake\" },\r\n      { key: \"checkHealth\", label: \"Check health signs daily\" },\r\n    ];\r\n    const habit = allHabits.find(h => h.key === key);\r\n    return habit ? habit.label : key;\r\n  };\r\n\r\n  useEffect(() => {\r\n    // Load saved user first\r\n    const savedUser = localStorage.getItem(\"currentUser\");\r\n    if (savedUser) {\r\n      try {\r\n        const userData = JSON.parse(savedUser);\r\n        setUser(userData);\r\n        \r\n        // Load habits specific to this user\r\n        const userHabitsKey = `habits_${userData.email}`;\r\n        const savedUserHabits = localStorage.getItem(userHabitsKey);\r\n        if (savedUserHabits) {\r\n          try {\r\n            const userHabits = JSON.parse(savedUserHabits);\r\n            setHabits(userHabits);\r\n            if (userHabits.length > 0) {\r\n              setHabitSelection(\"existing\");\r\n            }\r\n          } catch {\r\n            setHabits([]);\r\n          }\r\n        }\r\n      } catch {\r\n        localStorage.removeItem(\"currentUser\");\r\n      }\r\n    }\r\n    \r\n    setIsLoaded(true);\r\n  }, []);\r\n\r\n  // Handle user login/registration\r\n  const handleUserSubmit = (userData: { username: string; age: number; email: string }) => {\r\n    setUser(userData);\r\n    localStorage.setItem(\"currentUser\", JSON.stringify(userData));\r\n    \r\n    // Load existing habits for this user\r\n    const userHabitsKey = `habits_${userData.email}`;\r\n    const savedUserHabits = localStorage.getItem(userHabitsKey);\r\n    if (savedUserHabits) {\r\n      try {\r\n        const userHabits = JSON.parse(savedUserHabits);\r\n        setHabits(userHabits);\r\n        // If user has habits, don't show habit selection\r\n        if (userHabits.length > 0) {\r\n          setHabitSelection(\"existing\"); // Mark that user has existing habits\r\n        }\r\n      } catch {\r\n        // If there's an error loading habits, start fresh\r\n        setHabits([]);\r\n      }\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (isLoaded && user) {\r\n      // Save habits specific to the current user's email\r\n      const userHabitsKey = `habits_${user.email}`;\r\n      localStorage.setItem(userHabitsKey, JSON.stringify(habits));\r\n    }\r\n  }, [habits, isLoaded, user]);\r\n\r\n  const addHabit = (name: string, person: string) => {\r\n    const currentMonthYear = new Date().toISOString().slice(0, 7);\r\n    const newHabit: Habit = {\r\n      id: Date.now().toString(),\r\n      name,\r\n      person,\r\n      dayRecords: [],\r\n      createdAt: new Date().toISOString(),\r\n      monthYear: currentMonthYear,\r\n    };\r\n    setHabits([...habits, newHabit]);\r\n    setCurrentHabitIndex(habits.length);\r\n  };\r\n  const updateHabitRecords = (habitId: string, dayRecords: DayRecord[]) => {\r\n    setHabits(habits.map((habit) => (habit.id === habitId ? { ...habit, dayRecords } : habit)));\r\n  };\r\n  \r\n  const updateHabit = (habitId: string, updatedFields: Partial<Habit>) => {\r\n    setHabits(habits.map((habit) => (habit.id === habitId ? { ...habit, ...updatedFields } : habit)));\r\n  };\r\n  const deleteHabit = (habitId: string) => {\r\n    const newHabits = habits.filter((h) => h.id !== habitId);\r\n    setHabits(newHabits);\r\n    if (currentHabitIndex >= newHabits.length && currentHabitIndex > 0) {\r\n      setCurrentHabitIndex(currentHabitIndex - 1);\r\n    }\r\n  };\r\n\r\n  const handleSwipe = () => {\r\n    if (!swipeStartFromNav) return; // Only allow swipe if started from nav\r\n    \r\n    const distance = touchStart - touchEnd;\r\n    const isLeftSwipe = distance > 50;\r\n    const isRightSwipe = distance < -50;\r\n    if (isLeftSwipe && currentHabitIndex < habits.length - 1) {\r\n      setCurrentHabitIndex(currentHabitIndex + 1);\r\n    } else if (isLeftSwipe && currentHabitIndex === habits.length - 1) {\r\n      setCurrentHabitIndex(0);\r\n    } else if (isRightSwipe && currentHabitIndex > 0) {\r\n      setCurrentHabitIndex(currentHabitIndex - 1);\r\n    } else if (isRightSwipe && currentHabitIndex === 0) {\r\n      setCurrentHabitIndex(habits.length - 1);\r\n    }\r\n    setSwipeStartFromNav(false); // Reset after swipe\r\n  };\r\n\r\n  if (!isLoaded) {\r\n    return (\r\n      <div className=\"flex items-center justify-center min-h-screen bg-gradient-to-br from-background to-muted\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4\"></div>\r\n          <p className=\"text-foreground\">Loading your habits...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Show onboarding form first\r\n  if (!user) {\r\n    return (\r\n      <main className=\"flex items-center justify-center min-h-screen bg-gradient-to-br from-background to-muted\">\r\n        <FirstUserForm onSubmit={handleUserSubmit} />\r\n      </main>\r\n    );\r\n  }\r\n\r\n  // Show habit selection after onboarding (only if user doesn't have existing habits)\r\n  if (!habitSelection && !customHabitType && habits.length === 0) {\r\n    return (\r\n      <main className=\"flex items-center justify-center min-h-screen bg-gradient-to-br from-background to-muted\">\r\n        <HabitSelection\r\n          userAge={user?.age || 25}\r\n          onSelect={(habit) => {\r\n            if (habit === \"custom_make\") {\r\n              setCustomHabitType(\"make\");\r\n            } else if (habit === \"custom_break\") {\r\n              setCustomHabitType(\"break\");\r\n            } else if (habit.startsWith(\"custom_make:\")) {\r\n              // Extract custom habit name without prefix\r\n              const customHabitName = habit.replace(\"custom_make:\", \"\");\r\n              addHabit(customHabitName, \"__hide__\");\r\n              setHabitSelection(customHabitName);\r\n            } else if (habit.startsWith(\"custom_break:\")) {\r\n              // Extract custom habit name without prefix\r\n              const customHabitName = habit.replace(\"custom_break:\", \"\");\r\n              addHabit(customHabitName, \"__hide__\");\r\n              setHabitSelection(customHabitName);\r\n            } else {\r\n              const fullHabitName = getHabitNameFromKey(habit);\r\n              setHabitSelection(habit);\r\n              addHabit(fullHabitName, \"__hide__\");\r\n            }\r\n          }}\r\n        />\r\n      </main>\r\n    );\r\n  }\r\n\r\n  // Show custom habit creation screen\r\n  if (customHabitType) {\r\n    return (\r\n      <main className=\"flex items-center justify-center min-h-screen bg-gradient-to-br from-background to-muted\">\r\n        <div className=\"w-full max-w-md\">\r\n          <CustomHabitScreen\r\n            habitType={customHabitType}\r\n            onHabitCreate={(habitName) => {\r\n              addHabit(habitName, \"__hide__\");\r\n              setHabitSelection(habitName);\r\n              setCustomHabitType(null);\r\n            }}\r\n            onBack={() => setCustomHabitType(null)}\r\n          />\r\n        </div>\r\n      </main>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <main className=\"flex items-center justify-center min-h-screen bg-gradient-to-br from-background to-muted\">\r\n      <div\r\n        className=\"w-full h-screen max-w-md bg-background overflow-hidden flex flex-col\"\r\n      >\r\n        {showHabitSelection ? (\r\n          <HabitSelection\r\n            userName={user?.username}\r\n            userAge={user?.age || 25}\r\n            onBack={() => setShowHabitSelection(false)}\r\n            onSelect={(habit) => {\r\n              if (habit === \"custom_make\") {\r\n                setCustomHabitType(\"make\");\r\n                setShowHabitSelection(false);\r\n                setCurrentHabitIndex(habits.length);\r\n              } else if (habit === \"custom_break\") {\r\n                setCustomHabitType(\"break\");\r\n                setShowHabitSelection(false);\r\n                setCurrentHabitIndex(habits.length);\r\n              } else if (habit.startsWith(\"custom_make:\")) {\r\n                // Extract custom habit name without prefix\r\n                const customHabitName = habit.replace(\"custom_make:\", \"\");\r\n                const currentMonthYear = new Date().toISOString().slice(0, 7);\r\n                const newHabit: Habit = {\r\n                  id: Date.now().toString(),\r\n                  name: customHabitName,\r\n                  person: user?.username || \"User\",\r\n                  dayRecords: [],\r\n                  createdAt: new Date().toISOString(),\r\n                  monthYear: currentMonthYear,\r\n                };\r\n                setHabits([...habits, newHabit]);\r\n                setCurrentHabitIndex(habits.length);\r\n                setShowHabitSelection(false);\r\n              } else if (habit.startsWith(\"custom_break:\")) {\r\n                // Extract custom habit name without prefix\r\n                const customHabitName = habit.replace(\"custom_break:\", \"\");\r\n                const currentMonthYear = new Date().toISOString().slice(0, 7);\r\n                const newHabit: Habit = {\r\n                  id: Date.now().toString(),\r\n                  name: customHabitName,\r\n                  person: user?.username || \"User\",\r\n                  dayRecords: [],\r\n                  createdAt: new Date().toISOString(),\r\n                  monthYear: currentMonthYear,\r\n                };\r\n                setHabits([...habits, newHabit]);\r\n                setCurrentHabitIndex(habits.length);\r\n                setShowHabitSelection(false);\r\n              } else {\r\n                const fullHabitName = getHabitNameFromKey(habit);\r\n                setHabitSelection(habit);\r\n                setShowHabitSelection(false);\r\n                // Directly create the habit with the full name\r\n                const currentMonthYear = new Date().toISOString().slice(0, 7);\r\n                const newHabit: Habit = {\r\n                  id: Date.now().toString(),\r\n                  name: fullHabitName,\r\n                  person: user?.username || \"User\",\r\n                  dayRecords: [],\r\n                  createdAt: new Date().toISOString(),\r\n                  monthYear: currentMonthYear,\r\n                };\r\n                setHabits([...habits, newHabit]);\r\n                setCurrentHabitIndex(habits.length);\r\n              }\r\n            }}\r\n          />\r\n        ) : (habits.length === 0 || currentHabitIndex === habits.length) ? (\r\n          <HabitTracker\r\n            habit={null}\r\n            onAddHabit={addHabit}\r\n            onUpdateRecords={() => {}}\r\n            onDeleteHabit={() => {}}\r\n            onUpdateHabit={() => {}}\r\n            onViewChange={setCurrentView}\r\n            isNewHabitMode={true}\r\n          />\r\n        ) : (\r\n          <>\r\n            <div \r\n              className=\"bg-card border-b border-foreground/10 p-3 flex items-center justify-between gap-2\"\r\n              onTouchStart={(e) => {\r\n                setTouchStart(e.targetTouches[0].clientX);\r\n                setSwipeStartFromNav(true);\r\n              }}\r\n              onTouchEnd={(e) => {\r\n                if (swipeStartFromNav) {\r\n                  setTouchEnd(e.changedTouches[0].clientX);\r\n                  handleSwipe();\r\n                }\r\n              }}\r\n            >\r\n              <button\r\n                onClick={() => setShowProfileDrawer(true)}\r\n                className=\"p-2 hover:bg-muted rounded-full transition-colors border border-foreground/20\"\r\n                title=\"Profile\"\r\n              >\r\n                <svg className=\"w-6 h-6 text-foreground\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\" />\r\n                </svg>\r\n              </button>\r\n              <div className=\"flex-1 mr-1\">\r\n                <h1 className=\"text-base font-bold text-foreground truncate\" style={{ maxWidth: 'calc(100vw - 120px)' }}>\r\n                  {getHabitNameFromKey(habits[currentHabitIndex]?.name) || habits[currentHabitIndex]?.name}\r\n                </h1>\r\n                <div className=\"text-xs text-muted-foreground\">\r\n                  Created: {new Date(habits[currentHabitIndex]?.createdAt || '').toLocaleDateString('en-US', { \r\n                    month: 'short', \r\n                    day: 'numeric', \r\n                    year: 'numeric' \r\n                  })}\r\n                </div>\r\n              </div>\r\n              <button\r\n                onClick={() => setShowHabitSelection(true)}\r\n                className=\"bg-primary text-primary-foreground font-semibold rounded text-xs hover:opacity-90 transition-opacity px-3 py-2\"\r\n                title=\"Add new habit\"\r\n                style={{ minWidth: '60px', height: '32px' }}\r\n              >\r\n                + Add\r\n              </button>\r\n            </div>\r\n\r\n            {/* Statistics Display Box */}\r\n            <div className=\"bg-muted/50 border-b border-foreground/10 p-3 mx-4 mt-2 rounded-lg\">\r\n              <div className=\"flex justify-between items-center text-sm\">\r\n                <div className=\"flex flex-col items-center\">\r\n                  <span className=\"font-semibold text-foreground\">Successful days</span>\r\n                  <span className=\"text-lg font-bold text-green-600\">\r\n                    {(() => {\r\n                      const records = habits[currentHabitIndex]?.dayRecords || [];\r\n                      const habit = habits[currentHabitIndex];\r\n                      \r\n                      // Count actual successful days - when Y increased from previous day\r\n                      const completed = (() => {\r\n                        const records = habits[currentHabitIndex]?.dayRecords || [];\r\n                        let successfulDays = 0;\r\n                        records.forEach((record, index) => {\r\n                          if (index === 0) {\r\n                            // First day success if y > 0\r\n                            if (record.y > 0) successfulDays++;\r\n                          } else {\r\n                            const prevRecord = records[index - 1];\r\n                            // Success only when Y increased from previous day\r\n                            if (record.y > prevRecord.y) {\r\n                              successfulDays++;\r\n                            }\r\n                          }\r\n                        });\r\n                        return successfulDays;\r\n                      })();\r\n                      \r\n                      // Chart view always shows X/30, Calendar view shows dynamic days, Companion view shows pattern-based limit\r\n                      if (currentView === 'chart') {\r\n                        // Chart view always shows /30 constant\r\n                        return `${completed}/30`;\r\n                      } else if (currentView === 'companion') {\r\n                        // Companion view shows pattern-based limit: lock=30, unicorn=60\r\n                        const maxDots = habit?.companionPattern === 'lock' ? 30 : 60;\r\n                        return `${completed}/${maxDots}`;\r\n                      } else {\r\n                        // Calculate challenge days based on habit creation date for calendar view\r\n                        const currentDate = new Date();\r\n                        const startDate = new Date(habit?.createdAt || '');\r\n                        const currentMonth = currentDate.getMonth();\r\n                        const currentYear = currentDate.getFullYear();\r\n                        const habitStartDay = startDate.getDate();\r\n                        const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();\r\n                        const challengeDays = daysInMonth - habitStartDay + 1;\r\n                        return `${completed}/${challengeDays}`;\r\n                      }\r\n                    })()}\r\n                  </span>\r\n                </div>\r\n                <div className=\"flex flex-col items-center\">\r\n                  <span className=\"font-semibold text-foreground\">Missed days</span>\r\n                  <span className=\"text-lg font-bold text-red-500\">\r\n                    {(() => {\r\n                      const records = habits[currentHabitIndex]?.dayRecords || [];\r\n                      let missedCount = 0;\r\n                      \r\n                      records.forEach((record, index) => {\r\n                        if (index === 0) {\r\n                          // First day is missed only if y === 0 AND there was an intention to start\r\n                          if (record.y === 0 && record.x === 1) missedCount++;\r\n                        } else {\r\n                          const prevRecord = records[index - 1];\r\n                          \r\n                          // Missed day = when Y DECREASED from previous day (habit missed button clicked)\r\n                          if (record.y < prevRecord.y) {\r\n                            missedCount++;\r\n                          }\r\n                        }\r\n                      });\r\n                      return missedCount;\r\n                    })()}\r\n                  </span>\r\n                </div>\r\n                <div className=\"flex flex-col items-center\">\r\n                  <span className=\"font-semibold text-foreground\">Conversion</span>\r\n                  <span className=\"text-lg font-bold text-primary\">\r\n                    {(() => {\r\n                      const habit = habits[currentHabitIndex];\r\n                      if (!habit) return \"0%\";\r\n                      const records = habit.dayRecords || [];\r\n                      \r\n                      if (records.length === 0) return \"0%\";\r\n                      \r\n                      // Count actual successful days - when Y increased from previous day  \r\n                      const successCount = (() => {\r\n                        let successfulDays = 0;\r\n                        records.forEach((record, index) => {\r\n                          if (index === 0) {\r\n                            // First day success if y > 0\r\n                            if (record.y > 0) successfulDays++;\r\n                          } else {\r\n                            const prevRecord = records[index - 1];\r\n                            // Success only when Y increased from previous day\r\n                            if (record.y > prevRecord.y) {\r\n                              successfulDays++;\r\n                            }\r\n                          }\r\n                        });\r\n                        return successfulDays;\r\n                      })();\r\n                      const attemptedDays = records.length > 0 ? records[records.length - 1].x : 0;\r\n                      \r\n                      if (attemptedDays === 0) return \"0%\";\r\n                      \r\n                      // IMPORTANT: Calculate based on 30 days total so first completion = 3.3%\r\n                      const conversionPercentage = (successCount / 30) * 100;\r\n                      return Math.round(conversionPercentage * 10) / 10 + \"%\";\r\n                    })()}\r\n                  </span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Habit Tracker Content */}\r\n            <div className=\"flex-1 overflow-auto\">\r\n              <HabitTracker\r\n                habit={habits[currentHabitIndex]}\r\n                onAddHabit={addHabit}\r\n                onUpdateRecords={(dayRecords) => updateHabitRecords(habits[currentHabitIndex].id, dayRecords)}\r\n                onDeleteHabit={() => deleteHabit(habits[currentHabitIndex].id)}\r\n                onUpdateHabit={(updatedFields) => updateHabit(habits[currentHabitIndex].id, updatedFields)}\r\n                onViewChange={setCurrentView}\r\n                isNewHabitMode={false}\r\n              />\r\n            </div>\r\n          </>\r\n        )}\r\n        \r\n        \r\n        {/* Profile Side Drawer */}\r\n        {showProfileDrawer && (\r\n          <div className=\"fixed inset-0 z-50\">\r\n            {/* Backdrop */}\r\n            <div\r\n              className=\"absolute inset-0 bg-black/50\"\r\n              onClick={() => setShowProfileDrawer(false)}\r\n            />\r\n            \r\n            {/* Drawer - Mobile view format */}\r\n            <div className=\"absolute left-0 top-0 h-full w-3/4 max-w-sm bg-background border-r border-foreground/20 shadow-xl\">\r\n              <div className=\"p-6 space-y-6 h-full overflow-y-auto\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <h2 className=\"text-xl font-bold text-foreground\">Profile</h2>\r\n                  <button\r\n                    onClick={() => setShowProfileDrawer(false)}\r\n                    className=\"p-1 hover:bg-muted rounded\"\r\n                  >\r\n                    <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M6 18L18 6M6 6l12 12\" />\r\n                    </svg>\r\n                  </button>\r\n                </div>\r\n                \r\n                {/* Profile Information */}\r\n                <div className=\"space-y-4\">\r\n                  <div className=\"flex items-center gap-3\">\r\n                    <div className=\"w-12 h-12 bg-primary rounded-full flex items-center justify-center\">\r\n                      <svg className=\"w-8 h-8 text-primary-foreground\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\" />\r\n                      </svg>\r\n                    </div>\r\n                    <div>\r\n                      <div className=\"font-semibold text-foreground\">\r\n                        {user?.username || 'User'}\r\n                      </div>\r\n                      <div className=\"text-sm text-muted-foreground\">\r\n                        {user?.email || 'user@example.com'}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                  \r\n                  <div className=\"text-sm text-muted-foreground\">\r\n                    Age: {user?.age || 'Not specified'}\r\n                  </div>\r\n                  \r\n                  <div className=\"text-sm text-muted-foreground\">\r\n                    Date Joined: {new Date().toLocaleDateString()}\r\n                  </div>\r\n                </div>\r\n                \r\n                {/* Menu Options */}\r\n                <div className=\"space-y-2 pt-4 border-t border-foreground/10\">\r\n                  <button\r\n                    onClick={() => setShowLogoutConfirmation(true)}\r\n                    className=\"w-full text-left p-3 hover:bg-muted rounded-lg transition-colors\"\r\n                  >\r\n                    <div className=\"font-medium\">Log out</div>\r\n                    <div className=\"text-sm text-muted-foreground\">Sign out of your account</div>\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Logout Confirmation Dialog */}\r\n        {showLogoutConfirmation && (\r\n          <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\r\n            <div className=\"bg-background border border-border rounded-lg p-6 max-w-sm mx-4 shadow-lg\">\r\n              <h3 className=\"text-lg font-semibold text-foreground mb-4 text-center\">\r\n                Do you want to log out?\r\n              </h3>\r\n              <div className=\"flex gap-3 mt-4\">\r\n                <button\r\n                  onClick={() => {\r\n                    // Handle logout\r\n                    localStorage.removeItem('currentUser');\r\n                    // Don't remove user-specific habits - they should persist for next login\r\n                    setUser(null);\r\n                    setHabits([]);\r\n                    setHabitSelection(null);\r\n                    setShowProfileDrawer(false);\r\n                    setShowLogoutConfirmation(false);\r\n                    // Reset to first user form or login screen\r\n                  }}\r\n                  className=\"flex-1 px-4 py-2 bg-blue-500 text-white font-semibold rounded-md hover:bg-blue-600 transition-colors\"\r\n                >\r\n                  Yes\r\n                </button>\r\n                <button\r\n                  onClick={() => setShowLogoutConfirmation(false)}\r\n                  className=\"flex-1 px-4 py-2 bg-gray-200 text-gray-800 font-semibold rounded-md hover:bg-gray-300 transition-colors\"\r\n                >\r\n                  No\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </main>\r\n  );\r\n}\r\n"],"names":["useState","useEffect","HabitTracker","FirstUserForm","HabitSelection","CustomHabitScreen","Habit","DayRecord","Page","habits","setHabits","currentHabitIndex","setCurrentHabitIndex","isLoaded","setIsLoaded","touchStart","setTouchStart","touchEnd","setTouchEnd","swipeStartFromNav","setSwipeStartFromNav","user","setUser","username","age","email","habitSelection","setHabitSelection","customHabitType","setCustomHabitType","showHabitSelection","setShowHabitSelection","showProfileDrawer","setShowProfileDrawer","showLogoutConfirmation","setShowLogoutConfirmation","currentView","setCurrentView","getHabitNameFromKey","key","allHabits","label","habit","find","h","savedUser","localStorage","getItem","userData","JSON","parse","userHabitsKey","savedUserHabits","userHabits","length","removeItem","handleUserSubmit","setItem","stringify","addHabit","name","person","currentMonthYear","Date","toISOString","slice","newHabit","id","now","toString","dayRecords","createdAt","monthYear","updateHabitRecords","habitId","map","updateHabit","updatedFields","Partial","deleteHabit","newHabits","filter","handleSwipe","distance","isLeftSwipe","isRightSwipe","startsWith","customHabitName","replace","fullHabitName","habitName","e","targetTouches","clientX","changedTouches","maxWidth","toLocaleDateString","month","day","year","minWidth","height","records","completed","successfulDays","forEach","record","index","y","prevRecord","maxDots","companionPattern","currentDate","startDate","currentMonth","getMonth","currentYear","getFullYear","habitStartDay","getDate","daysInMonth","challengeDays","missedCount","x","successCount","attemptedDays","conversionPercentage","Math","round"],"mappings":"","ignoreList":[]}}]
}