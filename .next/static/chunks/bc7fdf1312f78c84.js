(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,31713,e=>{"use strict";var t=e.i(95424),r=e.i(36719);function l({gridSize:e,spacing:r,dotSize:l,dayRecords:a}){return(0,t.jsx)("div",{className:"relative",style:{width:e*r,height:e*r},children:Array.from({length:e},(e,t)=>t+1).map(s=>Array.from({length:e},(e,t)=>t+1).map(o=>{let n=((e,t)=>{let r=a.find(r=>r.x===e&&r.y===t);if(!r)return"none";if(e>1){let t=a.find(t=>t.x===e-1);if(t){if(r.y>t.y);else if(r.y<t.y)return"missed"}}else if(1===e)return r.y>0?"success":"missed";return"success"})(s,o);return(0,t.jsx)("div",{className:`absolute rounded-full transition-all ${"success"===n?"bg-primary scale-150 shadow-lg":"missed"===n?"bg-red-500 scale-150 shadow-lg":"bg-muted scale-100"}`,style:{width:l,height:l,left:s*r-r/2,top:(e-o+1)*r-r/2,transform:"translate(-50%, -50%)"}},`${s}-${o}`)}))})}function a({dayRecords:e}){(0,r.useMemo)(()=>{if(0===e.length)return 0;let t=0;return e.forEach((r,l)=>{let a=l>0?e[l-1]:null,s=a?a.y:0;r.y>s&&t++}),t},[e]);let a=(0,r.useMemo)(()=>{if(0===e.length)return"";let t=[];return e.forEach(e=>{let r=10*e.x-5+8,l=(30-e.y+1)*10-5+8;t.push(`${r},${l}`)}),"M "+t.join(" L ")},[e,30,10]);return(0,t.jsx)("div",{className:"flex flex-col items-center gap-2 pl-8 pr-8 py-2 w-full h-full",children:(0,t.jsxs)("div",{className:"relative flex-shrink-0",children:[(0,t.jsx)("div",{className:"absolute -left-10 top-0 flex flex-col justify-between text-xs font-semibold text-foreground",style:{height:316,paddingTop:8,paddingBottom:8},children:Array.from({length:30},(e,r)=>{let l=30-r;return(0,t.jsx)("div",{className:"flex items-center justify-end w-8",style:{height:10},children:(0,t.jsx)("span",{className:"text-right pr-2 text-gray-700",style:{fontSize:"11px",lineHeight:"12px",fontWeight:"600"},children:l%5==0?l:""})},l)})}),(0,t.jsxs)("div",{className:"relative bg-card border border-foreground/20 rounded-lg p-1 shadow-md",style:{width:316,height:316},children:[(0,t.jsxs)("svg",{width:332,height:332,className:"absolute inset-0 pointer-events-none",children:[(0,t.jsx)("line",{x1:13,y1:303,x2:303,y2:13,stroke:"black",strokeWidth:"1"}),e.length>0&&(0,t.jsx)("polyline",{points:a,fill:"none",stroke:"currentColor",strokeWidth:"2",className:"text-primary"})]}),(0,t.jsx)(l,{gridSize:30,spacing:10,dotSize:6,dayRecords:e})]}),(0,t.jsx)("div",{className:"flex justify-between mt-1 text-xs font-semibold text-foreground",style:{width:316,paddingLeft:8,paddingRight:8},children:Array.from({length:30},(e,r)=>{let l=r+1;return(0,t.jsx)("div",{className:"flex justify-center",style:{width:10},children:(0,t.jsx)("span",{className:"text-xs",style:{fontSize:"10px"},children:l%5==0?l:""})},l)})})]})})}function s({onSave:e,isSaved:l,habitData:a}){let[s,o]=(0,r.useState)(a.name);return(0,t.jsx)("div",{className:"w-full flex flex-col items-center justify-center min-h-screen p-4 gap-6",children:(0,t.jsxs)("div",{className:"w-full max-w-sm bg-card border border-foreground/10 rounded-lg p-6 shadow-md",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-foreground mb-4 text-center",children:"Create New Habit"}),(0,t.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-foreground mb-2",children:"Habit Name"}),(0,t.jsx)("input",{type:"text",value:s,onChange:e=>o(e.target.value),placeholder:"e.g., Phone Habit",className:"w-full px-4 py-2 border border-foreground/20 rounded-lg bg-background text-foreground placeholder-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary"})]}),(0,t.jsx)("button",{onClick:()=>{s.trim()&&(e(s,""),o(""))},disabled:!s.trim(),className:"w-full px-4 py-3 bg-primary text-primary-foreground font-semibold rounded-lg hover:opacity-90 transition-opacity border border-primary disabled:opacity-50 disabled:cursor-not-allowed mt-2",children:"Create Habit"})]})]})})}function o({dayRecords:e,habitStartDate:r}){let l=new Date,a=l.getMonth(),s=l.getFullYear(),o=new Date(r).getDate(),n=new Date(s,a+1,0).getDate(),i=new Date(s,a,1).getDay(),d=t=>{if(t<o)return"inactive";let r=t-o+1,l=e.find(e=>e.x===r);if(!l)return"pending";let a=e.find(e=>e.x===r-1),s=a?a.y:0;return l.y>s?"completed":"missed"},c=[];for(let e=0;e<i;e++)c.push((0,t.jsx)("div",{className:"w-10 h-10"},`empty-${e}`));for(let e=1;e<=n;e++){let r=d(e),a=e===l.getDate();c.push((0,t.jsxs)("div",{className:`w-10 h-10 flex items-center justify-center text-sm font-medium relative ${a?"ring-1 ring-blue-400":""}`,style:{backgroundColor:"inactive"===r?"#f3f4f6":"#ffffff",color:"inactive"===r?"#9ca3af":"#374151",border:"1px solid #e5e7eb",borderRadius:"2px"},children:[(0,t.jsx)("span",{className:`${"inactive"===r?"opacity-60":""} relative z-10`,children:e}),"completed"===r&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"absolute inset-0 rounded-sm",style:{backgroundColor:"rgba(34, 197, 94, 0.15)"}}),(0,t.jsx)("div",{className:"absolute top-1 right-1 w-6 h-6 rounded-full flex items-center justify-center text-white text-sm font-bold",style:{backgroundColor:"#22c55e"},children:"âœ“"})]}),"missed"===r&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"absolute inset-0 rounded-sm",style:{backgroundColor:"rgba(239, 68, 68, 0.15)"}}),(0,t.jsx)("div",{className:"absolute top-1 right-1 w-6 h-6 rounded-full flex items-center justify-center text-white text-sm font-bold",style:{backgroundColor:"#ef4444"},children:"âœ—"})]})]},e))}return(0,t.jsxs)("div",{className:"bg-white rounded-lg p-4 shadow-sm border border-gray-200 max-w-sm mx-auto",children:[(0,t.jsxs)("div",{className:"text-center mb-4",children:[(0,t.jsxs)("h2",{className:"text-xl font-bold text-gray-800 mb-1",children:[n-o+1," DAYS CHALLENGE"]}),(0,t.jsx)("div",{className:"text-sm font-medium text-gray-600 mb-3",children:["January","February","March","April","May","June","July","August","September","October","November","December"][a].toUpperCase()})]}),(0,t.jsxs)("div",{className:"grid grid-cols-7 gap-1 mb-3",children:[["S","M","T","W","T","F","S"].map((e,r)=>(0,t.jsx)("div",{className:"w-10 h-6 flex items-center justify-center text-xs font-medium text-gray-500",children:e},e)),c]}),(0,t.jsxs)("div",{className:"flex justify-center gap-4 text-xs text-gray-600",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded",style:{backgroundColor:"#f3f4f6"}}),(0,t.jsx)("span",{children:"Inactive"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)("span",{className:"w-3 h-3 rounded bg-green-500 text-white text-xs flex items-center justify-center",children:"âœ“"}),(0,t.jsx)("span",{children:"Done"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)("span",{className:"w-3 h-3 rounded bg-red-500 text-white text-xs flex items-center justify-center",children:"âœ—"}),(0,t.jsx)("span",{children:"Missed"})]})]})]})}function n({imagePath:e,dotsData:l,completedDays:a,imageWidth:s=600,imageHeight:o=600,imageOpacity:n=.35}){let[i,d]=(0,r.useState)(!1),[c,m]=(0,r.useState)(!1);return l&&0!==l.length?(0,t.jsx)("div",{className:"w-full",children:(0,t.jsx)("div",{className:"relative w-full border border-gray-200 rounded-lg overflow-hidden aspect-square",children:(0,t.jsxs)("svg",{width:"100%",height:"100%",viewBox:`0 0 ${s} ${o}`,className:"w-full h-full border border-gray-300 rounded-lg shadow-sm",style:{backgroundColor:"white"},preserveAspectRatio:"xMidYMid meet",children:[(0,t.jsx)("defs",{children:(0,t.jsx)("pattern",{id:"backgroundImage",patternUnits:"userSpaceOnUse",width:s,height:o,children:(0,t.jsx)("image",{href:e,x:"0",y:"0",width:s,height:o,opacity:n,onLoad:()=>{console.log("âœ… Image loaded:",e),d(!0)},onError:t=>{console.error("âŒ Ghoda image failed:",e,t),m(!0)}})})}),(0,t.jsx)("rect",{width:"100%",height:"100%",fill:i&&!c?"url(#backgroundImage)":"white"}),l.map((e,r)=>(0,t.jsxs)("g",{children:[(0,t.jsx)("circle",{cx:e.x,cy:e.y,r:"12",fill:r<a?"#000000":"#ffffff",stroke:"#1f2937",strokeWidth:"2"}),(0,t.jsx)("text",{x:e.x,y:e.y+5,textAnchor:"middle",className:"text-sm font-bold",fill:"#000000",fontSize:"12",children:r+1})]},r)),a>0&&l.slice(0,a+1).map((e,r)=>{if(0===r)return null;let a=l[r-1];return(0,t.jsx)("line",{x1:a.x,y1:a.y,x2:e.x,y2:e.y,stroke:"#000000",strokeWidth:"4",strokeLinecap:"round"},`line-${r}`)})]})})}):(0,t.jsx)("div",{className:"w-full h-96 flex items-center justify-center border rounded-lg bg-gray-50",children:(0,t.jsx)("p",{className:"text-gray-600",children:"No dot data provided"})})}let i=[{x:228,y:118},{x:229,y:180},{x:245,y:158},{x:262,y:116},{x:281,y:74},{x:306,y:35},{x:327,y:90},{x:340,y:134},{x:355,y:172},{x:446,y:232},{x:466,y:317},{x:446,y:403},{x:466,y:457},{x:525,y:455},{x:521,y:475},{x:562,y:490},{x:626,y:423},{x:711,y:391},{x:760,y:429},{x:762,y:490},{x:739,y:556},{x:676,y:532},{x:602,y:541},{x:601,y:587},{x:585,y:640},{x:643,y:680},{x:658,y:720},{x:605,y:748},{x:564,y:693},{x:586,y:749},{x:529,y:771},{x:496,y:731},{x:443,y:707},{x:358,y:714},{x:248,y:662},{x:183,y:709},{x:152,y:739},{x:91,y:704},{x:102,y:686},{x:52,y:658},{x:73,y:615},{x:166,y:518},{x:161,y:485},{x:100,y:460},{x:41,y:401},{x:29,y:323},{x:61,y:267},{x:123,y:260},{x:170,y:248},{x:232,y:294},{x:319,y:292},{x:369,y:262},{x:402,y:307},{x:373,y:346},{x:332,y:358},{x:314,y:410},{x:309,y:467},{x:339,y:529},{x:410,y:562},{x:470,y:543}],d=[{x:334,y:458},{x:242,y:414},{x:178,y:320},{x:180,y:230},{x:141,y:203},{x:156,y:148},{x:218,y:150},{x:284,y:109},{x:367,y:84},{x:457,y:98},{x:539,y:137},{x:587,y:208},{x:600,y:304},{x:552,y:408},{x:479,y:450},{x:486,y:474},{x:543,y:494},{x:576,y:544},{x:574,y:623},{x:539,y:680},{x:462,y:711},{x:369,y:709},{x:290,y:674},{x:253,y:597},{x:275,y:518},{x:330,y:483},{x:343,y:540},{x:482,y:524},{x:517,y:577},{x:495,y:645}];function c({habit:e,dayRecords:l}){let[a,s]=(0,r.useState)("unicorn"),o=(0,r.useMemo)(()=>{if(0===l.length)return 0;let e=0;return l.forEach((t,r)=>{let a=r>0?l[r-1]:null,s=a?a.y:0;t.y>s&&e++}),e},[l]);return(0,t.jsx)("div",{className:"w-full",children:(0,t.jsx)(n,{imagePath:"/illustrations/ghoda.png",dotsData:i,completedDays:o,imageWidth:800,imageHeight:800,imageOpacity:.35})})}function m({habit:e,dayRecords:l}){let[a,s]=(0,r.useState)("lock"),o=(0,r.useMemo)(()=>{if(0===l.length)return 0;let e=0;return l.forEach((t,r)=>{let a=r>0?l[r-1]:null,s=a?a.y:0;t.y>s&&e++}),e},[l]);return(0,t.jsx)("div",{className:"w-full",children:(0,t.jsx)(n,{imagePath:"/illustrations/Lock.jpg",dotsData:d,completedDays:o,imageWidth:800,imageHeight:800,imageOpacity:.2})})}function x({habit:e,onAddHabit:l,onUpdateRecords:n,onDeleteHabit:i,isNewHabitMode:d,onUpdateHabit:x,onViewChange:u}){let[h,y]=(0,r.useState)([]),[f,b]=(0,r.useState)(!1),[g,p]=(0,r.useState)(!1),[k,j]=(0,r.useState)(!1),[N,v]=(0,r.useState)(e?.preferredView||"chart"),[w,S]=(0,r.useState)(!1),[C,D]=(0,r.useState)(e?.companionPattern||"unicorn"),[M,L]=(0,r.useState)(!e?.companionPattern);return((0,r.useEffect)(()=>{"companion"===N&&!e?.companionPattern&&h.length>0&&30>=(h[h.length-1]?.y||0)&&(D("lock"),x&&e&&x({...e,companionPattern:"lock"}),L(!1))},[N,e?.companionPattern,h,x]),(0,r.useEffect)(()=>{"companion"===N||e?.companionPattern||L(!0)},[N,e?.companionPattern]),(0,r.useEffect)(()=>{let e=e=>{k&&j(!1)};return k&&document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}},[k]),(0,r.useEffect)(()=>{if(e){let t=new Date().toISOString().slice(0,7);e.monthYear!==t?y([]):y(e.dayRecords),b(!0)}else y([]),b(!1)},[e]),(0,r.useEffect)(()=>{f&&e&&n(h)},[h,f]),d)?(0,t.jsx)(s,{onSave:(e,t)=>{l(e,t),b(!0)},isSaved:!1,habitData:{name:"",person:""}}):(0,t.jsx)("div",{className:"flex flex-col h-full px-4 py-2",children:e&&f&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"relative flex items-center justify-end py-2 flex-shrink-0",children:[(0,t.jsxs)("button",{onClick:()=>j(!k),className:"flex items-center gap-1 text-base font-semibold text-right hover:text-primary transition-colors",children:["chart"===N?"Chart view":"calendar"===N?"Calendar view":"Companion view",(0,t.jsx)("span",{className:`transform transition-transform ${k?"rotate-180":""}`,children:"â–¼"})]}),k&&(0,t.jsxs)("div",{className:"absolute top-8 right-0 bg-background border border-foreground/20 rounded-md shadow-lg z-10 min-w-32",onClick:e=>e.stopPropagation(),children:[(0,t.jsx)("button",{onClick:()=>{v("chart"),j(!1),u?.("chart"),e&&x&&x({...e,preferredView:"chart"})},className:`w-full px-3 py-2 text-left hover:bg-muted transition-colors text-sm ${"chart"===N?"bg-muted font-semibold":""}`,children:"Chart view"}),(0,t.jsx)("button",{onClick:()=>{v("calendar"),S(!0),j(!1),u?.("calendar"),e&&x&&x({...e,preferredView:"calendar"})},className:`w-full px-3 py-2 text-left hover:bg-muted transition-colors text-sm ${"calendar"===N?"bg-muted font-semibold":""}`,children:"Calendar view"}),(0,t.jsx)("button",{onClick:()=>{v("companion"),j(!1),u?.("companion"),e&&x&&x({...e,preferredView:"companion"})},className:`w-full px-3 py-2 text-left hover:bg-muted transition-colors text-sm ${"companion"===N?"bg-muted font-semibold":""}`,children:"Companion view"})]})]}),(0,t.jsx)("div",{className:"w-full py-4",children:"chart"===N?(0,t.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,t.jsx)(a,{dayRecords:h})}):"calendar"===N?(0,t.jsx)(o,{dayRecords:h,habitStartDate:e.createdAt}):(0,t.jsx)("div",{className:"w-full",children:M?(0,t.jsxs)("div",{className:"flex flex-col items-center space-y-6 py-8",children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-center",children:"Choose Your Drawing Pattern"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4 w-full max-w-md",children:[(0,t.jsxs)("div",{onClick:()=>D("unicorn"),className:`border-2 rounded-lg p-4 text-center cursor-pointer transition-all ${"unicorn"===C?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,children:[(0,t.jsx)("div",{className:"text-lg font-semibold",children:"ðŸ¦„ Unicorn"}),(0,t.jsx)("div",{className:"text-sm text-gray-600 mt-1",children:"60 dots journey"})]}),(0,t.jsxs)("div",{onClick:()=>D("lock"),className:`border-2 rounded-lg p-4 text-center cursor-pointer transition-all ${"lock"===C?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,children:[(0,t.jsx)("div",{className:"text-lg font-semibold",children:"ðŸ”’ Lock"}),(0,t.jsx)("div",{className:"text-sm text-gray-600 mt-1",children:"30 dots journey"})]})]}),(0,t.jsx)("button",{onClick:()=>{L(!1),x&&e&&x({...e,companionPattern:C})},className:"px-6 py-3 bg-blue-500 text-white font-semibold rounded-lg hover:bg-blue-600 transition-colors",children:"Continue"})]}):(0,t.jsx)("div",{className:"w-full",children:"unicorn"===C?(0,t.jsx)(c,{habit:e,dayRecords:h}):(0,t.jsx)(m,{habit:e,dayRecords:h})})})}),!("companion"===N&&M)&&(0,t.jsxs)("div",{className:"flex gap-2 flex-shrink-0 px-2",children:[(0,t.jsx)("button",{onClick:()=>{y(e=>{let t,r,l=e[e.length-1];if(!l)return[{x:1,y:1}];let a=l.x+1,s=l.y+1;return("companion"===N?r=t="lock"===C?30:60:(t=30,r=30),a<=t&&s<=r)?[...e,{x:a,y:s}]:e})},className:"flex-1 px-3 py-2.5 bg-primary text-primary-foreground font-semibold rounded-lg hover:opacity-90 transition-opacity border-2 border-primary shadow-md text-center text-sm",children:"Let's Go"}),(0,t.jsx)("button",{onClick:()=>{0!==h.length&&y(e=>{let t=e[e.length-1],r=t.x+1,l=Math.max(0,t.y-1);return r<=("companion"===N?"lock"===C?30:60:30)?[...e,{x:r,y:l}]:e})},className:"flex-1 px-3 py-2.5 bg-red-500 text-white font-semibold rounded-lg hover:bg-red-600 transition-colors border-2 border-red-500 shadow-md text-center text-sm",children:"Habit missed"})]}),!("companion"===N&&M)&&h.length>0&&h[h.length-1]?.y>0&&(0,t.jsx)("div",{className:"w-full text-center text-sm font-semibold py-3 flex-shrink-0",children:(0,t.jsx)("button",{onClick:()=>{p(!0)},className:"underline text-foreground hover:text-muted-foreground transition-colors",children:"Want to give up"})}),g&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,t.jsxs)("div",{className:"bg-background border border-border rounded-lg p-6 max-w-sm mx-4 shadow-lg",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-foreground mb-4 text-center",children:"Do you really don't want to continue?"}),(0,t.jsxs)("div",{className:"flex gap-3 mt-4",children:[(0,t.jsx)("button",{onClick:()=>{i(),p(!1)},className:"flex-1 px-4 py-2 bg-red-500 text-white font-semibold rounded-md hover:bg-red-600 transition-colors",children:"Yes"}),(0,t.jsx)("button",{onClick:()=>{p(!1)},className:"flex-1 px-4 py-2 bg-gray-200 text-gray-800 font-semibold rounded-md hover:bg-gray-300 transition-colors",children:"No"})]})]})})]})})}function u({onSubmit:e}){let[l,a]=(0,r.useState)(""),[s,o]=(0,r.useState)(""),[n,i]=(0,r.useState)(""),[d,c]=(0,r.useState)(""),[m,x]=(0,r.useState)([]),[u,h]=(0,r.useState)(!1),y=l.trim()&&""!==s&&n.trim();return(0,r.useEffect)(()=>{let e=localStorage.getItem("savedUsers");if(e)try{let t=JSON.parse(e);x(t),t.length>0&&h(!1)}catch{x([])}},[]),(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen p-4",style:{backgroundColor:"#f3f4f6"},children:(0,t.jsxs)("div",{className:"w-full max-w-sm rounded-xl shadow-lg p-8 text-center",style:{backgroundColor:"#ffffff"},children:[(0,t.jsx)("div",{className:"mb-6",children:(0,t.jsx)("div",{className:"w-16 h-16 mx-auto rounded-xl flex items-center justify-center",style:{background:"linear-gradient(135deg, #22d3ee 0%, #3b82f6 100%)"},children:(0,t.jsx)("svg",{className:"w-10 h-10 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})}),u?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold mb-2",style:{color:"#1f2937"},children:"Welcome Back!"}),(0,t.jsx)("p",{className:"mb-6",style:{color:"#6b7280"},children:"Select your account to continue"}),(0,t.jsx)("div",{className:"space-y-3",children:m.map((r,l)=>(0,t.jsx)("button",{onClick:()=>{e(r)},className:"w-full p-4 rounded-lg text-left transition-colors border",style:{backgroundColor:"#f9fafb",borderColor:"#e5e7eb"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#f3f4f6",e.currentTarget.style.borderColor="#22d3ee"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="#f9fafb",e.currentTarget.style.borderColor="#e5e7eb"},children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-white font-semibold",style:{background:"linear-gradient(135deg, #22d3ee 0%, #3b82f6 100%)"},children:r.username.charAt(0).toUpperCase()}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"font-medium",style:{color:"#1f2937"},children:r.username}),(0,t.jsx)("div",{className:"text-sm",style:{color:"#6b7280"},children:r.email})]})]})},l))}),(0,t.jsx)("button",{onClick:()=>h(!1),className:"mt-4 text-sm font-medium",style:{color:"#6b7280"},onMouseEnter:e=>e.target.style.color="#22d3ee",onMouseLeave:e=>e.target.style.color="#6b7280",children:"â† Back to Sign Up"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold mb-2",style:{color:"#1f2937"},children:"Join Our Community"}),(0,t.jsx)("p",{className:"mb-8",style:{color:"#6b7280"},children:"Become part of something great"}),(0,t.jsxs)("form",{onSubmit:t=>{(t.preventDefault(),l.trim()&&""!==s&&n.trim())?n.trim().endsWith("@gmail.com")?(c(""),(async()=>{try{let t=await fetch("/api/register-user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:l,age:s,email:n})});if(!t.ok){let e=await t.json().catch(()=>({}));c(e.error||"Failed to register");return}let r={username:l,age:s,email:n},a=[...m.filter(e=>e.email!==n),r];localStorage.setItem("savedUsers",JSON.stringify(a)),e(r)}catch(e){console.error(e),c("Network error")}})()):c("Please enter a valid Gmail address ending with @gmail.com"):c("Please fill in all fields.")},className:"space-y-4",children:[(0,t.jsx)("input",{type:"text",placeholder:"What's your name?",value:l,onChange:e=>a(e.target.value),className:"w-full px-4 py-3 border-0 rounded-lg",style:{backgroundColor:"#f9fafb",color:"#374151",outline:"none"},onFocus:e=>e.target.style.outline="2px solid #22d3ee",onBlur:e=>e.target.style.outline="none",required:!0}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("select",{value:s,onChange:e=>o(Number(e.target.value)),className:"w-full px-4 py-3 border-0 rounded-lg appearance-none",style:{backgroundColor:"#f9fafb",color:""===s?"#9ca3af":"#374151",outline:"none"},onFocus:e=>e.target.style.outline="2px solid #22d3ee",onBlur:e=>e.target.style.outline="none",required:!0,children:[(0,t.jsx)("option",{value:"",style:{color:"#9ca3af"},children:"How old are you?"}),Array.from({length:66},(e,t)=>15+t).map(e=>(0,t.jsx)("option",{value:e,style:{color:"#374151"},children:e},e))]}),(0,t.jsx)("span",{className:"pointer-events-none absolute inset-y-0 right-3 flex items-center",style:{color:"#9ca3af"},children:"â–¼"})]}),(0,t.jsx)("input",{type:"email",placeholder:"Your email address",value:n,onChange:e=>i(e.target.value),className:"w-full px-4 py-3 border-0 rounded-lg",style:{backgroundColor:"#f9fafb",color:"#374151",outline:"none"},onFocus:e=>e.target.style.outline="2px solid #22d3ee",onBlur:e=>e.target.style.outline="none",required:!0}),d&&(0,t.jsx)("div",{className:"text-sm text-center",style:{color:"#ef4444"},children:d}),(0,t.jsx)("button",{type:"submit",className:"w-full px-4 py-3 font-semibold rounded-lg transition-all",style:{background:y?"linear-gradient(135deg, #22d3ee 0%, #3b82f6 100%)":"#d1d5db",color:y?"#ffffff":"#6b7280",cursor:y?"pointer":"not-allowed",boxShadow:y?"0 4px 6px -1px rgba(0, 0, 0, 0.1)":"none"},disabled:!y,children:"Let's Go!"})]}),m.length>0&&(0,t.jsx)("div",{className:"mt-6 pt-4",style:{borderTop:"1px solid #e5e7eb"},children:(0,t.jsxs)("p",{className:"text-sm mb-2",style:{color:"#6b7280"},children:["Been here before?"," ",(0,t.jsx)("button",{onClick:()=>h(!0),className:"font-medium hover:underline",style:{color:"#22d3ee"},children:"Log In"})]})})]})]})})}function h({onSelect:e,onBack:l,userName:a,userAge:s=25}){let[o,n]=(0,r.useState)("make"),[i,d]=(0,r.useState)(""),[c,m]=(0,r.useState)(""),x=((e,t)=>{if(e>=15&&e<=20)return"make"===t?[{key:"study",label:"Study 25 mins focused",emoji:"ðŸ“š"},{key:"walk",label:"Walk briskly 15 mins",emoji:"ðŸš¶"},{key:"meditate",label:"Meditate 5 mins daily",emoji:"ðŸ§˜"},{key:"read",label:"Read 10 pages daily",emoji:"ðŸ“–"}]:[{key:"noPhone",label:"No phone after 9 PM",emoji:"ðŸ“µ"},{key:"noSoda",label:"No soda every day",emoji:"ðŸ¥¤"},{key:"sleep",label:"Sleep 7 hrs min",emoji:"ðŸ˜´"},{key:"noJunk",label:"No junk food daily",emoji:"ðŸŸ"}];if(e>=21&&e<=25)return"make"===t?[{key:"save",label:"Save â‚¹100 daily auto",emoji:"ðŸ’°"},{key:"cook",label:"Cook breakfast daily",emoji:"ðŸ³"},{key:"callFriend",label:"Call friend nightly",emoji:"ðŸ“ž"},{key:"stretch",label:"Stretch after waking",emoji:"ðŸ¤¸"}]:[{key:"limitCoffee",label:"Limit coffee to 1 cup",emoji:"â˜•"},{key:"noScreens",label:"No screens after 10 PM",emoji:"ðŸ“º"},{key:"walkShort",label:"Walk short distances",emoji:"ðŸš¶"},{key:"noLateNights",label:"No late nights out",emoji:"ðŸŒ™"}];if(e>=26&&e<=30)return"make"===t?[{key:"readNews",label:"Read news with tea",emoji:"ðŸ“°"},{key:"water",label:"Drink 2L water daily",emoji:"ðŸ’§"},{key:"hobby",label:"Hobby 20 mins daily",emoji:"ðŸŽ¨"},{key:"planMeals",label:"Plan meals weekly",emoji:"ðŸ“‹"}]:[{key:"noEatingOut",label:"No daily eating out",emoji:"ðŸ½ï¸"},{key:"workLimit",label:"Limit work to 8 hrs",emoji:"â°"},{key:"noSnacks",label:"No snacks after 8 PM",emoji:"ðŸª"},{key:"trackExpenses",label:"Track expenses daily",emoji:"ðŸ’³"}];if(e>=31&&e<=35)return"make"===t?[{key:"familyChat",label:"Family chat 15 mins",emoji:"ðŸ‘¨â€ðŸ‘©â€ðŸ‘§â€ðŸ‘¦"},{key:"strength",label:"Strength train 20 mins",emoji:"ðŸ’ª"},{key:"breathing",label:"Deep breaths morning",emoji:"ðŸ«‘"},{key:"journal",label:"Journal before bed",emoji:"ðŸ“"}]:[{key:"singleTask",label:"Single-task only",emoji:"ðŸŽ¯"},{key:"noSugary",label:"No sugary drinks",emoji:"ðŸ¥¤"},{key:"bedTime",label:"Bed by 11 PM",emoji:"ðŸ˜´"},{key:"noWeekendScreens",label:"No weekend screens",emoji:"ðŸ“º"}];if(e>=36&&e<=40)return"make"===t?[{key:"freshLunch",label:"Fresh lunch daily",emoji:"ðŸ¥—"},{key:"walkMorning",label:"Walk before 8 AM",emoji:"ðŸš¶"},{key:"waterFirst",label:"Drink water AM first",emoji:"ðŸ’§"},{key:"stretchDaily",label:"Stretch 10 mins daily",emoji:"ðŸ¤¸"}]:[{key:"noFoodAfter8",label:"No food after 8 PM",emoji:"ðŸ½ï¸"},{key:"standHourly",label:"Stand every 1 hour",emoji:"ðŸ§"},{key:"moveHourly",label:"Move every hour",emoji:"ðŸš¶"},{key:"cutAlcohol",label:"Cut alcohol intake",emoji:"ðŸ·"}];else return"make"===t?[{key:"yoga",label:"Yoga 15 mins daily",emoji:"ðŸ§˜"},{key:"stretchBed",label:"Stretch before bed",emoji:"ðŸ¤¸"},{key:"fruitBreakfast",label:"Fruit in breakfast",emoji:"ðŸŽ"},{key:"puzzle",label:"Puzzle 10 mins daily",emoji:"ðŸ§©"}]:[{key:"noPackaged",label:"No packaged foods",emoji:"ðŸ“¦"},{key:"stand30Min",label:"Stand every 30 mins",emoji:"ðŸ§"},{key:"limitSugar",label:"Limit sugar daily",emoji:"ðŸ­"},{key:"healthCheck",label:"Daily health check",emoji:"ðŸ©º"}]})(s,o),u=async()=>{if(c.trim()){try{await fetch("/api/track-custom-habit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({habitName:c.trim(),habitType:o,userAge:s,userName:a})})}catch(e){console.error("Failed to track custom habit:",e)}e("make"===o?`custom_make:${c.trim()}`:`custom_break:${c.trim()}`)}else i&&e(i)},h=i||c.trim();return(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen p-4",style:{backgroundColor:"#f3f4f6"},children:(0,t.jsxs)("div",{className:"w-full max-w-md rounded-xl shadow-lg p-3 mx-2",style:{backgroundColor:"#ffffff"},children:[l&&(0,t.jsxs)("div",{className:"flex items-center mb-6",children:[(0,t.jsx)("button",{onClick:l,className:"p-2 hover:bg-gray-100 rounded-full transition-colors mr-4",style:{color:"#6b7280"},children:(0,t.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})})}),(0,t.jsxs)("h1",{className:"text-lg font-bold",style:{color:"#1f2937"},children:["Welcome, ",a||"User","!"]})]}),(0,t.jsxs)("div",{className:"flex mb-6",children:[(0,t.jsx)("button",{className:`flex-1 px-4 py-3 font-semibold border-2 rounded-l-lg transition-colors ${"make"===o?"border-gray-800 bg-white text-gray-800":"border-gray-300 bg-gray-100 text-gray-600"}`,onClick:()=>{n("make"),d(""),m("")},children:"Make Habit"}),(0,t.jsx)("button",{className:`flex-1 px-4 py-3 font-semibold border-2 border-l-0 rounded-r-lg transition-colors ${"break"===o?"border-gray-800 bg-white text-gray-800":"border-gray-300 bg-gray-100 text-gray-600"}`,onClick:()=>{n("break"),d(""),m("")},children:"Break Habit"})]}),(0,t.jsx)("div",{className:"mb-4",children:(0,t.jsx)("div",{className:"grid grid-cols-2 gap-3",children:x.map(e=>(0,t.jsxs)("button",{className:`p-3 rounded-xl text-center transition-all border-2 flex flex-col items-center gap-2 ${i===e.key?"border-gray-400 bg-gray-200":"border-gray-200 bg-gray-50 hover:border-gray-300"}`,onClick:()=>{d(i===e.key?"":e.key),c&&m("")},children:[(0,t.jsx)("span",{className:"text-2xl",children:e.emoji}),(0,t.jsx)("span",{className:"text-sm font-medium text-gray-700 leading-tight",children:e.label})]},e.key))})}),(0,t.jsxs)("div",{className:"mb-3",children:[(0,t.jsxs)("div",{className:"flex gap-1 items-stretch",children:[(0,t.jsx)("input",{type:"text",placeholder:"Create your own habit...",value:c,maxLength:25,onChange:e=>{m(e.target.value),i&&d("")},className:"flex-1 px-2 py-3 text-base border-2 border-gray-300 rounded-lg focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition-all",style:{color:"#374151",minWidth:0}}),(0,t.jsx)("button",{onClick:()=>c&&u(),disabled:!c.trim(),className:`px-2 py-3 rounded-lg font-semibold text-base transition-all w-12 flex items-center justify-center border-2 flex-shrink-0 ${c.trim()?"bg-gray-800 text-white hover:bg-gray-700 shadow-lg border-gray-800":"bg-gray-300 text-gray-500 cursor-not-allowed border-gray-300"}`,children:(0,t.jsx)("span",{className:"text-base font-bold",children:"+"})})]}),c&&(0,t.jsx)("div",{className:"text-right mt-2",children:(0,t.jsxs)("span",{className:"text-sm",style:{color:c.length>=25?"#ef4444":"#6b7280"},children:[c.length,"/",25]})})]}),(0,t.jsx)("button",{onClick:u,className:"w-full px-4 py-3 font-semibold rounded-lg transition-all",style:{backgroundColor:h?"#1f2937":"#d1d5db",color:h?"#ffffff":"#6b7280",cursor:h?"pointer":"not-allowed"},disabled:!h,children:"Start Building"})]})})}function y({habitType:e,onHabitCreate:l,onBack:a}){let[s,o]=(0,r.useState)("");return(0,t.jsxs)("div",{className:"flex flex-col h-screen bg-background",children:[(0,t.jsx)("div",{className:"px-4 py-3 bg-card border-b border-border",children:(0,t.jsx)("button",{onClick:a,className:"px-3 py-2 bg-muted text-muted-foreground hover:bg-muted/80 transition-colors font-medium text-sm rounded-md",children:"â† Back"})}),(0,t.jsxs)("div",{className:"flex-1 p-4 flex flex-col justify-center max-w-md mx-auto w-full",children:[(0,t.jsx)("h1",{className:"text-xl font-bold text-foreground mb-4 text-center",children:"make"===e?"What are you really good at? but not consistent with it...":"What are the bad habits which you are trying to break?"}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("textarea",{className:"w-full border-2 border-input rounded-lg p-3 text-base bg-background text-foreground min-h-[100px] resize-none focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Describe in an one line",value:s,onChange:e=>o(e.target.value),maxLength:200}),(0,t.jsxs)("div",{className:"text-xs text-muted-foreground text-right mt-1",children:[s.length,"/200"]})]}),(0,t.jsx)("button",{className:`w-full py-4 rounded-lg text-base font-bold transition-colors ${s.trim()?"bg-primary text-primary-foreground hover:bg-primary/90":"bg-muted text-muted-foreground cursor-not-allowed"}`,onClick:()=>{s.trim()?l(s.trim()):alert("Please describe your habit")},disabled:!s.trim(),children:"Let's Build â†’"})]})]})}function f(){let e,l,[a,s]=(0,r.useState)([]),[o,n]=(0,r.useState)(0),[i,d]=(0,r.useState)(!1),[c,m]=(0,r.useState)(0),[f,b]=(0,r.useState)(0),[g,p]=(0,r.useState)(!1),[k,j]=(0,r.useState)(null),[N,v]=(0,r.useState)(null),[w,S]=(0,r.useState)(null),[C,D]=(0,r.useState)(!1),[M,L]=(0,r.useState)(!1),[P,A]=(0,r.useState)(!1),[W,_]=(0,r.useState)("chart"),$=e=>{let t=[{key:"study",label:"Study focused for 25 mins"},{key:"walk",label:"Walk briskly 15 mins daily"},{key:"meditate",label:"Meditate calmly for 10 mins"},{key:"read",label:"Read 10 pages daily"},{key:"noPhone",label:"No phone after 9 PM"},{key:"noSoda",label:"Skip soda daily"},{key:"sleep",label:"Avoid sleeping less than 7 hours"},{key:"noJunk",label:"Avoid junk food daily"},{key:"noPackaged",label:"No packaged foods"},{key:"save",label:"Saved â‚¹100 everyday"},{key:"cook",label:"Cook breakfast before work"},{key:"callFriend",label:"Call one friend after dinner"},{key:"stretch",label:"Stretch after waking up"},{key:"limitCoffee",label:"Limit coffee to one cup"},{key:"noScreens",label:"No screens after 10 PM"},{key:"walkInstead",label:"Walk instead of driving short distances"},{key:"noLateNights",label:"Cut late nights"},{key:"readNews",label:"Read news during morning tea"},{key:"water",label:"Drink 2L of water daily"},{key:"hobby",label:"Do hobby 20 mins daily"},{key:"planMeals",label:"Plan meals for the week"},{key:"noEatingOut",label:"No eating out daily"},{key:"workLimit",label:"Work limit 8 hours"},{key:"noSnacks",label:"No snacks after 8 PM"},{key:"trackExpenses",label:"Track daily expenses"},{key:"familyChat",label:"Family chat 15 mins"},{key:"strength",label:"Strength training 20 mins"},{key:"breathing",label:"Deep breathing after waking up"},{key:"journal",label:"Journal before sleep"},{key:"oneTask",label:"One task at a time (no multitasking)"},{key:"noSugary",label:"Skip sugary drinks"},{key:"bedtime",label:"Bedtime by 11 PM"},{key:"noWeekendBinge",label:"No weekend screen binge"},{key:"freshLunch",label:"Lunch cooked fresh daily"},{key:"morningWalk",label:"Morning walk before 8 AM"},{key:"waterMorning",label:"Drink 2 glasses of water in the morning"},{key:"stretchDaily",label:"Stretch 10 mins daily"},{key:"noFoodAfter8",label:"No food after 8 PM"},{key:"stand2Min",label:"Stand for 2 minutes every hour"},{key:"moveHourly",label:"Move body every hour"},{key:"reduceAlcohol",label:"Reduce alcohol intake"},{key:"yoga",label:"Yoga 15 mins"},{key:"stretchBed",label:"Stretch before bed"},{key:"fruitBreakfast",label:"Eat fruit with breakfast"},{key:"puzzle",label:"Solve puzzle 10 mins"},{key:"noProcessed",label:"No processed packaged foods"},{key:"stand30Min",label:"Stand every 30 mins"},{key:"limitSugar",label:"Limit sugar intake"},{key:"checkHealth",label:"Check health signs daily"}].find(t=>t.key===e);return t?t.label:e};(0,r.useEffect)(()=>{let e=localStorage.getItem("currentUser");if(e)try{let t=JSON.parse(e);j(t);let r=`habits_${t.email}`,l=localStorage.getItem(r);if(l)try{let e=JSON.parse(l);s(e),e.length>0&&v("existing")}catch{s([])}}catch{localStorage.removeItem("currentUser")}d(!0)},[]),(0,r.useEffect)(()=>{if(i&&k){let e=`habits_${k.email}`;localStorage.setItem(e,JSON.stringify(a))}},[a,i,k]);let O=(e,t)=>{let r=new Date().toISOString().slice(0,7);s([...a,{id:Date.now().toString(),name:e,person:t,dayRecords:[],createdAt:new Date().toISOString(),monthYear:r}]),n(a.length)};return i?k?N||w||0!==a.length?w?(0,t.jsx)("main",{className:"flex items-center justify-center min-h-screen bg-gradient-to-br from-background to-muted",children:(0,t.jsx)("div",{className:"w-full max-w-md",children:(0,t.jsx)(y,{habitType:w,onHabitCreate:e=>{O(e,"__hide__"),v(e),S(null)},onBack:()=>S(null)})})}):(0,t.jsx)("main",{className:"flex items-center justify-center min-h-screen bg-gradient-to-br from-background to-muted",children:(0,t.jsxs)("div",{className:"w-full h-screen max-w-md bg-background overflow-hidden flex flex-col",children:[C?(0,t.jsx)(h,{userName:k?.username,userAge:k?.age||25,onBack:()=>D(!1),onSelect:e=>{if("custom_make"===e)S("make"),D(!1),n(a.length);else if("custom_break"===e)S("break"),D(!1),n(a.length);else if(e.startsWith("custom_make:")){let t=e.replace("custom_make:",""),r=new Date().toISOString().slice(0,7);s([...a,{id:Date.now().toString(),name:t,person:k?.username||"User",dayRecords:[],createdAt:new Date().toISOString(),monthYear:r}]),n(a.length),D(!1)}else if(e.startsWith("custom_break:")){let t=e.replace("custom_break:",""),r=new Date().toISOString().slice(0,7);s([...a,{id:Date.now().toString(),name:t,person:k?.username||"User",dayRecords:[],createdAt:new Date().toISOString(),monthYear:r}]),n(a.length),D(!1)}else{let t=$(e);v(e),D(!1);let r=new Date().toISOString().slice(0,7);s([...a,{id:Date.now().toString(),name:t,person:k?.username||"User",dayRecords:[],createdAt:new Date().toISOString(),monthYear:r}]),n(a.length)}}}):0===a.length||o===a.length?(0,t.jsx)(x,{habit:null,onAddHabit:O,onUpdateRecords:()=>{},onDeleteHabit:()=>{},onUpdateHabit:()=>{},onViewChange:_,isNewHabitMode:!0}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"bg-card border-b border-foreground/10 p-3 flex items-center justify-between gap-2",onTouchStart:e=>{m(e.targetTouches[0].clientX),p(!0)},onTouchEnd:e=>{g&&(b(e.changedTouches[0].clientX),(()=>{if(!g)return;let e=c-f,t=e>50,r=e<-50;t&&o<a.length-1?n(o+1):t&&o===a.length-1?n(0):r&&o>0?n(o-1):r&&0===o&&n(a.length-1),p(!1)})())},children:[(0,t.jsx)("button",{onClick:()=>L(!0),className:"p-2 hover:bg-muted rounded-full transition-colors border border-foreground/20",title:"Profile",children:(0,t.jsx)("svg",{className:"w-6 h-6 text-foreground",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),(0,t.jsxs)("div",{className:"flex-1 mr-1",children:[(0,t.jsx)("h1",{className:"text-base font-bold text-foreground truncate",style:{maxWidth:"calc(100vw - 120px)"},children:$(a[o]?.name)||a[o]?.name}),(0,t.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Created: ",new Date(a[o]?.createdAt||"").toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})]})]}),(0,t.jsx)("button",{onClick:()=>D(!0),className:"bg-primary text-primary-foreground font-semibold rounded text-xs hover:opacity-90 transition-opacity px-3 py-2",title:"Add new habit",style:{minWidth:"60px",height:"32px"},children:"+ Add"})]}),(0,t.jsx)("div",{className:"bg-muted/50 border-b border-foreground/10 p-3 mx-4 mt-2 rounded-lg",children:(0,t.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,t.jsxs)("div",{className:"flex flex-col items-center",children:[(0,t.jsx)("span",{className:"font-semibold text-foreground",children:"Successful days"}),(0,t.jsx)("span",{className:"text-lg font-bold text-green-600",children:(()=>{let e,t;a[o]?.dayRecords;let r=a[o],l=(e=a[o]?.dayRecords||[],t=0,e.forEach((r,l)=>{if(0===l)r.y>0&&t++;else{let a=e[l-1];r.y>a.y&&t++}}),t);if("chart"===W)return`${l}/30`;if("companion"===W){let e=r?.companionPattern==="lock"?30:60;return`${l}/${e}`}{let e=new Date,t=new Date(r?.createdAt||""),a=e.getMonth(),s=e.getFullYear(),o=t.getDate(),n=new Date(s,a+1,0).getDate();return`${l}/${n-o+1}`}})()})]}),(0,t.jsxs)("div",{className:"flex flex-col items-center",children:[(0,t.jsx)("span",{className:"font-semibold text-foreground",children:"Missed days"}),(0,t.jsx)("span",{className:"text-lg font-bold text-red-500",children:(e=a[o]?.dayRecords||[],l=0,e.forEach((t,r)=>{if(0===r)0===t.y&&1===t.x&&l++;else{let a=e[r-1];t.y<a.y&&l++}}),l)})]}),(0,t.jsxs)("div",{className:"flex flex-col items-center",children:[(0,t.jsx)("span",{className:"font-semibold text-foreground",children:"Conversion"}),(0,t.jsx)("span",{className:"text-lg font-bold text-primary",children:(()=>{let e,t=a[o];if(!t)return"0%";let r=t.dayRecords||[];if(0===r.length)return"0%";let l=(e=0,r.forEach((t,l)=>{if(0===l)t.y>0&&e++;else{let a=r[l-1];t.y>a.y&&e++}}),e);return 0===(r.length>0?r[r.length-1].x:0)?"0%":Math.round(l/30*1e3)/10+"%"})()})]})]})}),(0,t.jsx)("div",{className:"flex-1 overflow-auto",children:(0,t.jsx)(x,{habit:a[o],onAddHabit:O,onUpdateRecords:e=>{var t;return t=a[o].id,void s(a.map(r=>r.id===t?{...r,dayRecords:e}:r))},onDeleteHabit:()=>{var e;let t;return e=a[o].id,void(s(t=a.filter(t=>t.id!==e)),o>=t.length&&o>0&&n(o-1))},onUpdateHabit:e=>{var t;return t=a[o].id,void s(a.map(r=>r.id===t?{...r,...e}:r))},onViewChange:_,isNewHabitMode:!1})})]}),M&&(0,t.jsxs)("div",{className:"fixed inset-0 z-50",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-black/50",onClick:()=>L(!1)}),(0,t.jsx)("div",{className:"absolute left-0 top-0 h-full w-3/4 max-w-sm bg-background border-r border-foreground/20 shadow-xl",children:(0,t.jsxs)("div",{className:"p-6 space-y-6 h-full overflow-y-auto",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-foreground",children:"Profile"}),(0,t.jsx)("button",{onClick:()=>L(!1),className:"p-1 hover:bg-muted rounded",children:(0,t.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-primary rounded-full flex items-center justify-center",children:(0,t.jsx)("svg",{className:"w-8 h-8 text-primary-foreground",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-semibold text-foreground",children:k?.username||"User"}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:k?.email||"user@example.com"})]})]}),(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Age: ",k?.age||"Not specified"]}),(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Date Joined: ",new Date().toLocaleDateString()]})]}),(0,t.jsx)("div",{className:"space-y-2 pt-4 border-t border-foreground/10",children:(0,t.jsxs)("button",{onClick:()=>A(!0),className:"w-full text-left p-3 hover:bg-muted rounded-lg transition-colors",children:[(0,t.jsx)("div",{className:"font-medium",children:"Log out"}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Sign out of your account"})]})})]})})]}),P&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,t.jsxs)("div",{className:"bg-background border border-border rounded-lg p-6 max-w-sm mx-4 shadow-lg",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-foreground mb-4 text-center",children:"Do you want to log out?"}),(0,t.jsxs)("div",{className:"flex gap-3 mt-4",children:[(0,t.jsx)("button",{onClick:()=>{localStorage.removeItem("currentUser"),j(null),s([]),v(null),L(!1),A(!1)},className:"flex-1 px-4 py-2 bg-blue-500 text-white font-semibold rounded-md hover:bg-blue-600 transition-colors",children:"Yes"}),(0,t.jsx)("button",{onClick:()=>A(!1),className:"flex-1 px-4 py-2 bg-gray-200 text-gray-800 font-semibold rounded-md hover:bg-gray-300 transition-colors",children:"No"})]})]})})]})}):(0,t.jsx)("main",{className:"flex items-center justify-center min-h-screen bg-gradient-to-br from-background to-muted",children:(0,t.jsx)(h,{userAge:k?.age||25,onSelect:e=>{if("custom_make"===e)S("make");else if("custom_break"===e)S("break");else if(e.startsWith("custom_make:")){let t=e.replace("custom_make:","");O(t,"__hide__"),v(t)}else if(e.startsWith("custom_break:")){let t=e.replace("custom_break:","");O(t,"__hide__"),v(t)}else{let t=$(e);v(e),O(t,"__hide__")}}})}):(0,t.jsx)("main",{className:"flex items-center justify-center min-h-screen bg-gradient-to-br from-background to-muted",children:(0,t.jsx)(u,{onSubmit:e=>{j(e),localStorage.setItem("currentUser",JSON.stringify(e));let t=`habits_${e.email}`,r=localStorage.getItem(t);if(r)try{let e=JSON.parse(r);s(e),e.length>0&&v("existing")}catch{s([])}}})}):(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gradient-to-br from-background to-muted",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-foreground",children:"Loading your habits..."})]})})}e.s(["default",()=>f],31713)}]);